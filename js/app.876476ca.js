(function(t){function e(e){for(var n,o,l=e[0],r=e[1],c=e[2],u=0,f=[];u<l.length;u++)o=l[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&f.push(s[o][0]),s[o]=0;for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);d&&d(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,l=1;l<i.length;l++){var r=i[l];0!==s[r]&&(n=!1)}n&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},s={app:0},a=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var d=r;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"198b":function(t,e,i){},"1dc0":function(t,e,i){"use strict";i("5df0")},"278a":function(t,e,i){},"2fdc":function(t,e,i){"use strict";i("c227")},"43fb":function(t,e,i){},5108:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("caad"),i("2532");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},a=[],o=(i("5c0b"),i("2877")),l={},r=Object(o["a"])(l,s,a,!1,null,null,null),c=r.exports,d=i("8c4f"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"editor"},[i("header",[i("Heading")],1),i("main",[i("Sidebar",{attrs:{id:"sidebar"}}),t.isAnySlideSelected?i("keep-alive",[i(t.activeSlideComponent,{tag:"component"})],1):i("div",{staticClass:"help_text"},[t._v("Чтобы начать редактирование, добавьте слайд ")])],1)])},f=[],h=i("5530"),m=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},p=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("nav",{staticClass:"header border-bottom navbar navbar-expand-md navbar-light"},[i("div",{staticClass:"logo"},[i("a",{staticClass:"navbar-brand",attrs:{href:"/"}},[t._v("iAudience")])]),i("div",{staticClass:"title"},[t._v(" Название теста ")]),i("div",{staticClass:"controls"},[i("ul",{staticClass:"navbar-nav"},[i("div",[i("a",{staticClass:"nav-link",attrs:{href:"#"}},[t._v("На главную")])]),i("div",{staticClass:"dropdown"},[i("a",{staticClass:"nav-link dropdown-toggle",attrs:{href:"#",role:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}},[t._v(" Вася Пупкин ")]),i("ul",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton1"}},[i("li",[i("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Профиль")])]),i("li",[i("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Настройки")])]),i("li",[i("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Выйти")])])])]),i("div",{staticClass:"dropdown"},[i("a",{staticClass:"nav-link dropdown-toggle",attrs:{href:"#",role:"button",id:"dropdownMenuLink","data-bs-toggle":"dropdown","aria-expanded":"false"}},[t._v(" Помощь ")]),i("ul",{staticClass:"dropdown-menu dropdown-menu-end",attrs:{"aria-labelledby":"dropdownMenuLink"}},[i("li",[i("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Редактор тестов")])]),i("li",[i("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Справочный центр")])]),i("li",[i("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Быстрый старт")])]),i("li",[i("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[t._v("Связаться с нами")])])])])])])])}],v={name:"Heading",props:{}},g=v,b=(i("d09c"),Object(o["a"])(g,m,p,!1,null,"4cf4bb6b",null)),y=b.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sidebar border-end"},[i("div",{ref:"slides",staticClass:"slides"},t._l(t.$store.state.slides,(function(e){return i("div",{key:e.id,staticClass:"slide_item",class:{selected:t.isSlideSelected(e.id)},on:{click:function(i){return t.setActiveSlide(e.id)}}},[i("SlidePreview",{attrs:{"slide-id":e.id}})],1)})),0),i("div",{staticClass:"controls",class:{"border-top":t.hasScroll}},[i("button",{staticClass:"btn btn-primary btn-lg",attrs:{type:"button"},on:{click:t.addSlide}},[t._v("Добавить слайд ")])])])},x=[],S=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"preview"},[t._v(" "+t._s(t.slideId)+" ")])},C=[],_={name:"SlidePreview",props:["slideId"]},E=_,k=(i("2fdc"),Object(o["a"])(E,S,C,!1,null,"5ec5f12e",null)),I=k.exports,O=i("2f62"),z="ADD_SLIDE",F="SET_ACTIVE_SLIDE",M="SET_SLIDE_TYPE",$="SET_SLIDE_SIZE",T="TOGGLE_GRID",j="ADD_SLIDE_ELEMENT",L="DELETE_SLIDE_ELEMENT",A="MOVE_SLIDE_ELEMENT",P="RESIZE_SLIDE_ELEMENT",H={name:"Sidebar",components:{SlidePreview:I},props:{},data:function(){return{mounted:!1}},computed:{hasScroll:function(){return!!this.mounted&&this.$refs.slides.scrollHeight>this.$refs.slides.clientHeight}},methods:Object(h["a"])(Object(h["a"])({},Object(O["d"])({addSlide:z,setActiveSlide:F})),{},{isSlideSelected:function(t){return t===this.$store.getters.activeSlide.id}}),mounted:function(){this.mounted=!0}},N=H,W=(i("be20"),Object(o["a"])(N,w,x,!1,null,"7836226f",null)),D=W.exports,R=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("SlideEditor",{attrs:{id:"slide_editor"},scopedSlots:t._u([{key:"params",fn:function(){return[i("div",{staticClass:"col"},[t._v(" SingleChoice params ")])]},proxy:!0},{key:"controls",fn:function(){return[t._v(" SingleChoice controls ")]},proxy:!0}])})},U=[],G=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"slide_editor"},[i("div",{staticClass:"params_area border-bottom"},[i("div",{staticClass:"row px-3"},[i("div",{staticClass:"col-3"},[i("label",{staticClass:"form-label",attrs:{for:"slideTypeSelect"}},[t._v(" Тип слайда ")]),i("select",{staticClass:"form-select",attrs:{id:"slideTypeSelect"},domProps:{value:t.activeSlide.type},on:{change:function(e){return t.setSlideType(e.target.value)}}},t._l(t.$store.state.slideTypes,(function(e){return i("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name)+" ")])})),0)]),t._t("params")],2)]),i("div",{staticClass:"slide_controls_area"},[i("div",{staticClass:"slide_area"},[i("RatioKeeper",{attrs:{ratio:16/9,"min-height":500}},[i("Slide")],1)],1),i("div",{staticClass:"controls_area border-start"},[i("button",{on:{click:t.addText}},[t._v(" Text ")]),i("button",{attrs:{disabled:""},on:{click:t.addImage}},[t._v(" Image ")]),i("button",{attrs:{disabled:""},on:{click:t.addYouTube}},[t._v(" YouTube ")]),t._t("controls"),i("div",{staticStyle:{flex:"1 1 auto"}}),i("button",{on:{click:t.toggleGrid}},[t._v("Показать/скрыть сетку ")]),i("button",{on:{click:t.logState}},[t._v("Log vuex state ")])],2)])])},X=[],Y="ADD_TEXT_ELEMENT",q="ADD_IMAGE_ELEMENT",Z="ADD_YOUTUBE_ELEMENT",B=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"content",staticClass:"content",style:t.styles},[t.ready?t._t("default"):t._e()],2)},K=[],J=i("1da1"),V=(i("96cf"),i("a9e3"),i("99af"),{name:"RatioKeeper",props:{ratio:Number,minHeight:Number},data:function(){return{ready:!1,height:0,paddingX:20,paddingY:16,horizontalScrollPadding:20}},computed:{contentWidth:function(){return(this.height-2*this.paddingY)*this.ratio+2*this.paddingX},contentHeight:function(){return this.height},styles:function(){return{width:this.contentWidth+"px",height:this.contentHeight+"px",padding:"".concat(this.paddingY,"px ").concat(this.paddingX,"px")}}},watch:{ratio:function(){this.keepAspectRatio()}},methods:{changeSelf:function(t){var e=this;this.ready=!1,t().then((function(){return e.ready=!0}))},keepAspectRatio:function(){var t=this;return Object(J["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=t.$refs.content.parentElement.clientHeight-t.horizontalScrollPadding,i>t.minHeight?t.height=i:t.height=t.minHeight;case 2:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){this.changeSelf(this.keepAspectRatio)},destroyed:function(){}}),Q=V,tt=(i("f8c1"),Object(o["a"])(Q,B,K,!1,null,"26a3712c",null)),et=tt.exports,it=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"slide",staticClass:"slide"},[t.$store.state.slideParams.showGrid?i("div",{staticClass:"grid",style:{"background-size":t.backgroundSize}}):t._e(),t._l(t.activeSlideElements,(function(e){return i("SlideElement",t._b({key:e.id},"SlideElement",{element:e,slideWidth:t.slideWidth,slideHeight:t.slideHeight,cellSize:t.cellSize},!1))}))],2)},nt=[],st=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"movable",staticClass:"movable",class:t.movableClasses,attrs:{tabindex:t.element.id},on:{dblclick:t.onDoubleClick,focusin:function(e){t.isElementFocused=!0},focusout:function(e){t.isElementFocused=!1},keyup:t.onKeyUp}},[i("span",{staticClass:"popup",class:{hidden:!t.isOnlyElementFocused}},[i("span",{staticClass:"d-flex"},[t._l(t.actions,(function(t,e){return i("button",{key:e,staticClass:"popup-button"},[i("i",{class:t.icon,on:{click:t.func}})])})),i("button",{staticClass:"popup-button"},[i("i",{staticClass:"far fa-trash-alt",on:{click:t.deleteSelf}})])],2)]),t.isOnlyElementFocused?[i("div",{ref:"top",staticClass:"size_change top"}),i("div",{ref:"right",staticClass:"size_change right"}),i("div",{ref:"bottom",staticClass:"size_change bottom"}),i("div",{ref:"left",staticClass:"size_change left"})]:t._e(),i(t.element.content.component,t._b({ref:"inner_component",tag:"component",staticClass:"inner_component",on:{focusin:function(e){t.isInnerFocused=!0},focusout:function(e){t.isInnerFocused=!1},"update-actions":t.updateActions}},"component",t.element.content,!1))],2)},at=[],ot=i("3835"),lt=(i("159b"),i("4fad"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"text_object",class:{inactive:!t.isActive}},[i("wysiwyg-math",{ref:"wysimath",attrs:{functions:["textStyle","fontSize","textAlign","lists","formulaInsert","redo"]},on:{focusout:t.onFocusOut}})],1)}),rt=[],ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wysimath"},[i("span",{staticClass:"popup",class:{hidden:!t.showPopup},on:{mousedown:t.preventHide}},[t.textStylesEnabled?i("span",{staticClass:"border-right d-flex"},t._l(t.fontStyles,(function(e,n){return i("button",{key:n,staticClass:"popup-button",class:{selected:e.selected},on:{click:function(i){return t.setStyle(e.style,!1,null,!0)}}},[i("i",{class:e.icon})])})),0):t._e(),t.fontSizeEnabled?i("span",{staticClass:"border-right d-flex"},[i("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedFontSize,expression:"selectedFontSize"}],on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedFontSize=e.target.multiple?i:i[0]},t.changeFontSize]}},t._l(t.newFontSizes,(function(e){return i("option",{key:e},[t._v(t._s(e))])})),0)]):t._e(),t.textAlignEnabled?i("span",{staticClass:"border-right d-flex"},t._l(t.textStyles,(function(e,n){return i("button",{key:n,staticClass:"popup-button",class:{selected:e.selected},on:{click:function(i){t.textAlign(e.style),e.selected=!e.selected}}},[i("i",{class:e.icon})])})),0):t._e(),t.listsEnabled?i("span",{staticClass:"border-right d-flex"},t._l(t.lists,(function(e,n){return i("button",{key:n,staticClass:"popup-button",class:{selected:e.selected},on:{click:function(i){return t.setStyle(e.style,!1,null)}}},[i("i",{class:e.icon})])})),0):t._e(),t.linksEnabled||t.codeEnabled||t.imagesEnabled||t.formulasEnabled?i("span",{staticClass:"border-right d-flex"},[t.linksEnabled?i("button",{staticClass:"popup-button",on:{click:t.insertLink}},[i("i",{staticClass:"fas fa-link"})]):t._e(),t.codeEnabled?i("button",{staticClass:"popup-button",on:{click:t.insertCode}},[i("i",{staticClass:"fas fa-code"})]):t._e(),t.imagesEnabled?i("button",{staticClass:"popup-button",on:{click:t.insertImage}},[i("i",{staticClass:"fas fa-image"})]):t._e(),t.formulasEnabled?i("button",{staticClass:"popup-button",on:{click:t.createFormula}},[i("i",{staticClass:"fas fa-square-root-alt"})]):t._e()]):t._e(),t.redoEnabled?i("span",[i("button",{staticClass:"popup-button",on:{click:function(e){return t.setStyle("undo")}}},[i("i",{staticClass:"fas fa-undo-alt"})])]):t._e()]),i("span",{ref:"textarea",staticClass:"form-control editor",attrs:{id:t.id,placeholder:t.placeholder,contenteditable:""},on:{focusin:function(e){t.showPopup=!0},focusout:t.hideSelf,input:t.onDivInput,change:t.onDivInput,keyup:t.updateCursorPos}}),i("formula-modal",{ref:"formulaAddModal",on:{"insert-latex":t.onInsertLaTeX}}),i("formula-modal",{ref:"formulaEditModal",attrs:{"is-in-edit-mode":""},on:{"insert-latex":t.onModifyLaTeX}}),i("image-modal",{ref:"imageAddModal",on:{"insert-images":t.onInsertImages}}),i("link-modal",{ref:"linkAddModal",on:{"insert-link":t.onInsertLink}}),i("code-modal",{ref:"codeAddModal",on:{"insert-code":t.onInsertCode}})],1)},dt=[],ut=(i("7db0"),i("a630"),i("3ca3"),i("d3b7"),i("25f0"),i("fb6a"),i("d81d"),i("b0c0"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],ref:"formula",staticClass:"wysiwyg-math-formula",attrs:{contenteditable:"false","data-latex":t.latex},on:{dblclick:t.edit}})}),ft=[],ht={name:"mathFormula",props:{latex:String},data:function(){return{show:!1}},methods:{edit:function(){window.bus.$emit("formula-click",{element:this.$refs.formula,latex:this.latex})},render:function(){var t=this;this.show=!1,setTimeout((function(){window.katex.render("".concat(t.latex),t.$refs.formula,{throwOnError:!1,output:"html"}),t.$refs.formula.innerHTML=" "+t.$refs.formula.innerHTML+" ",t.show=!0}),100)}},mounted:function(){this.render()}},mt=ht,pt=(i("d189"),Object(o["a"])(mt,ut,ft,!1,null,null,null)),vt=pt.exports,gt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showModal,expression:"showModal"}],staticClass:"modal-mask"},[i("div",{staticClass:"modal-wrapper"},[i("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v(t._s(t.isInEditMode?"Редактировать формулу":"Вставить формулу"))]),i("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){t.showModal=!1}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),i("div",{staticClass:"modal-body"},[i("div",{ref:"patterns",staticClass:"d-flex mb-3"},[i("div",{staticClass:"d-flex"},[i("div",{staticStyle:{position:"relative"}},[i("div",{staticClass:"py-1 px-2 text-center section-button",class:{expanded:t.showLetters},attrs:{tabindex:"0"},on:{click:function(e){t.showLetters=!t.showLetters},focusout:t.hideSelf}},[t._v(" \\(\\alpha \\beta \\delta\\) ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showLetters,expression:"showLetters"}],staticStyle:{"z-index":"100","background-color":"#ffffff",position:"absolute",top:"100%",left:"0","margin-top":"8px",border:"black 1px solid","border-radius":"4px",padding:"4px",display:"grid","grid-template-columns":"repeat(8, 1fr)","flex-wrap":"wrap","text-align":"center"},on:{mousedown:t.preventHide}},t._l(t.letters,(function(e,n){return i("div",{key:n,staticClass:"letter",on:{click:function(i){return t.insertLetter(e)}}},[t._v(" \\( "+t._s(e)+" \\) ")])})),0)]),i("div",{staticClass:"ml-2",staticStyle:{position:"relative"}},[i("div",{staticClass:"py-1 px-2 text-center section-button",class:{expanded:t.showOperators},attrs:{tabindex:"0"},on:{click:function(e){t.showOperators=!t.showOperators},focusout:t.hideSelf}},[t._v(" \\(\\sum\\) ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showOperators,expression:"showOperators"}],staticStyle:{"z-index":"100","background-color":"#ffffff",position:"absolute",top:"100%",left:"0","margin-top":"8px",border:"black 1px solid","border-radius":"4px",padding:"4px",display:"grid","grid-template-columns":"repeat(4, 1fr)","flex-wrap":"wrap","text-align":"center"},on:{mousedown:t.preventHide}},t._l(t.operators,(function(e,n){return i("div",{key:n,staticClass:"letter",on:{click:function(i){return t.insertOperator(e)}}},[t._v(" \\("+t._s(e)+"\\) ")])})),0)]),i("div",{staticClass:"ml-2",staticStyle:{position:"relative"}},[i("div",{staticClass:"py-1 px-2 text-center section-button",class:{expanded:t.showSymbols},attrs:{tabindex:"0"},on:{click:function(e){t.showSymbols=!t.showSymbols},focusout:t.hideSelf}},[t._v(" \\(\\neq\\) ")]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showSymbols,expression:"showSymbols"}],staticStyle:{"z-index":"100","background-color":"#ffffff",position:"absolute",top:"100%",left:"0","margin-top":"8px",border:"black 1px solid","border-radius":"4px",padding:"4px",display:"grid","grid-template-columns":"repeat(7, 1fr)","flex-wrap":"wrap","text-align":"center"},on:{mousedown:t.preventHide}},t._l(t.symbols,(function(e,n){return i("div",{key:n,staticClass:"letter",on:{click:function(i){return t.insertSymbol(e)}}},[t._v(" \\("+t._s(e)+"\\) ")])})),0)])])]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formula,expression:"formula"}],ref:"formulaTextarea",staticStyle:{width:"100%"},attrs:{rows:"3",autofocus:""},domProps:{value:t.formula},on:{click:t.updateFormulaCursorPos,keydown:t.updateFormulaCursorPos,input:function(e){e.target.composing||(t.formula=e.target.value)}}}),i("div",{staticStyle:{"font-weight":"bolder",margin:".8rem 0 .4rem"}},[t._v("Результат:")]),i("div",{ref:"formulaPreview",staticStyle:{margin:".5rem 0",height:"40px"}})]),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.showModal=!1}}},[t._v("Отмена")]),t.isInEditMode?i("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.saveFormula}},[t._v("Сохранить ")]):i("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.addFormula}},[t._v("Добавить ")])])])])])])])},bt=[],yt={name:"formulaModal",components:{mathFormula:vt},props:{isInEditMode:{type:Boolean,default:!1}},data:function(){return{showModal:!1,updateFormulaTimeout:null,formula:"",data:null,showLetters:!1,showOperators:!1,showSymbols:!1,preventHideFlag:!1,changeOpacity:!1,preventFormulaWatcher:!1,letters:["\\alpha","\\beta","\\gamma","\\delta","\\epsilon","\\zeta","\\eta","\\theta","\\iota","\\kappa","\\lambda","\\mu","\\nu","\\omicron","\\pi","\\rho","\\sigma","\\tau","\\upsilon","\\phi","\\chi","\\psi","\\omega","\\Gamma","\\Delta","\\Theta","\\Lambda","\\Xi","\\Pi","\\Upsilon","\\Phi","\\Psi","\\Omega","\\Sigma","\\mathbb{N}","\\mathbb{Z}","\\mathbb{Q}","\\mathbb{R}","\\mathbb{C}"],operators:["\\sqrt{ab}","\\sqrt[n]{ab}","\\log_{a}{b}","\\lg{ab}","a^{b}","a_{b} c_a^b","c_a^b","\\widetilde{ab}","\\widehat{ab}","\\overrightarrow{ab}","\\overline{ab}","\\frac{ab}{cd}","\\frac{\\partial a}{\\partial b}","\\frac{\\text{d}x}{\\text{d}y}","\\lim_{a \\rightarrow b}","\\int_{a}^{b}","\\prod_a^b","\\bigcap_a^b","\\bigcup_a^b","\\sum_a^b","\\left(\\begin{array}{c}a\\\\ b\\end{array}\\right)","\\begin{bmatrix}a & b \\\\c & d \\end{bmatrix}","\\begin{cases}a & x = 0\\\\b & x > 0\\end{cases}"],symbols:["\\times","\\div","\\pm","\\mp","\\cdot","\\star","\\neq","\\leq","\\geq","\\sim","\\approx","\\cong","\\equiv","\\ll","\\gg","\\in","\\subset","\\subseteq","\\ni","\\models","\\vdash","\\perp","\\mid","\\parallel","\\hat{a}","\\check{a}","\\acute{a}","\\tilde{a}","\\bar{a}","\\vec{a}","\\dot{a}","\\ddot{a}","\\leftarrow","\\Leftarrow","\\rightarrow","\\Rightarrow","\\leftrightarrow","\\Leftrightarrow","\\exists","\\forall","\\triangle","\\triangledown"]}},watch:{formula:function(){var t=this;this.updateFormulaTimeout&&clearTimeout(this.updateFormulaTimeout),this.preventFormulaWatcher?this.preventFormulaWatcher=!1:this.updateFormulaTimeout=setTimeout((function(){window.katex.render("".concat(t.formula),t.$refs.formulaPreview,{throwOnError:!1,output:"html"}),t.changeOpacity&&(t.$refs.formulaPreview.style.opacity=1,t.changeOpacity=!1)}),1500)},showModal:function(){this.showModal&&setTimeout((function(){}),1e3)}},methods:{toggle:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.data=e,this.formula="",this.$refs.formulaPreview.innerHTML="",this.isInEditMode&&(this.preventFormulaWatcher=!0,this.formula=e.latex,window.katex.render("".concat(this.formula),this.$refs.formulaPreview,{throwOnError:!1,output:"html"})),this.showModal=!0,this.$nextTick((function(){t.$refs.formulaTextarea.focus()}))},test:function(){console.log("123")},preventHide:function(){this.preventHideFlag=!0},hideSelf:function(){this.preventHideFlag?this.preventHideFlag=!this.preventHideFlag:(this.showLetters=!1,this.showOperators=!1,this.showSymbols=!1)},updateData:function(){this.data=this.$refs.textarea.innerHTML},updateFormulaCursorPos:function(t){var e=this;setTimeout((function(){e.formulaCursorPos=t.target.selectionStart}),100)},insertToFormula:function(t){void 0!==this.formulaCursorPos?this.formula=this.formula.slice(0,this.formulaCursorPos)+" ".concat(t," ")+this.formula.slice(this.formulaCursorPos):this.formula+=" ".concat(t," ")},insertLetter:function(t){this.showLetters=!1,this.insertToFormula(t)},insertOperator:function(t){this.showOperators=!1,this.insertToFormula(t)},insertSymbol:function(t){this.showSymbols=!1,this.insertToFormula(t)},addFormula:function(){this.showModal=!1,this.$emit("insert-latex",this.formula)},saveFormula:function(){this.showModal=!1,this.data.latex=this.formula,this.$emit("insert-latex",this.data)}}},wt=yt,xt=(i("b6af"),Object(o["a"])(wt,gt,bt,!1,null,null,null)),St=xt.exports,Ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showModal,expression:"showModal"}],staticClass:"modal-mask"},[i("div",{staticClass:"modal-wrapper"},[i("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("Вставить картинку")]),i("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){t.showModal=!1}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),i("div",{staticClass:"modal-body"},[i("input",{ref:"fileInput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.onUpload}}),t.isMultiple?i("div",{staticStyle:{"margin-top":"24px",display:"flex","justify-content":"space-evenly","align-items":"center"}},[i("button",{on:{click:function(e){t.activeFileIndex>0&&t.activeFileIndex--}}},[t._v("prev.")]),t._v(" Картинка "+t._s(t.activeFileIndex+1)+" из "+t._s(t.files.length)+" "),i("button",{on:{click:function(e){t.activeFileIndex<t.files.length-1&&t.activeFileIndex++}}},[t._v("next.")])]):t._e(),t.files.length>0?i("div",[i("div",{staticStyle:{"font-weight":"bolder","margin-top":".8rem"}},[t._v("Превью:")]),i("div",{ref:"imageDiv",staticClass:"image"},[i("img",{attrs:{src:t.activeFile.image.src,height:t.activeFile.image.height,width:t.activeFile.image.width}})]),i("div",{staticClass:"d-flex justify-content-center align-items-center"},[i("label",{staticStyle:{"margin-right":".4rem","margin-bottom":"0"},attrs:{for:"scale"}},[t._v("Масштаб:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.activeFile.scale,expression:"activeFile.scale"}],attrs:{type:"text",id:"scale",list:"scales"},domProps:{value:t.activeFile.scale},on:{input:function(e){e.target.composing||t.$set(t.activeFile,"scale",e.target.value)}}}),i("datalist",{attrs:{id:"scales"}},t._l(t.scales,(function(t){return i("option",{key:t,domProps:{value:t}})})),0)])]):t._e()]),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.showModal=!1}}},[t._v("Отмена")]),i("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:0===t.files.length},on:{click:t.addImage}},[t._v("Добавить ")])])])])])])])},_t=[],Et=(i("2b3d"),i("ddb0"),{name:"imageModal",props:{uploadUrl:{type:String,default:null}},data:function(){return{showModal:!1,scales:[25,50,75,100],activeFileIndex:0,files:[]}},computed:{isMultiple:function(){return this.files.length>1},activeFile:function(){return this.files[this.activeFileIndex]}},watch:{"activeFile.scale":function(t){t>100?this.activeFile.scale=100:t<0?this.activeFile.scale=1:void 0!==this.activeFile&&(this.activeFile.image.height=this.activeFile.baseHeight*this.activeFile.scale/100,this.activeFile.image.width=this.activeFile.baseWidth*this.activeFile.scale/100)}},methods:{toggle:function(){this.files=[],this.$refs.fileInput.value=null,this.showModal=!0},onUpload:function(t){var e=this,i=!1;if(Array.from(t.target.files).forEach((function(t){t.size>307200&&(i=!0)})),i)return alert("Максимальный размер одного файла - 300 Кбайт"),void(this.$refs.fileInput.value=null);this.files=[];var n=t.target.files.length;Array.from(t.target.files).forEach((function(t){var i={file:t,image:null,url:URL.createObjectURL(t),scale:100};function s(t){return new Promise((function(e,i){var n=new Image;n.onload=function(){e(this)},n.onerror=i,n.src=t}))}s(i.url).then((function(t){i.image=t,i.baseHeight=t.height,i.baseWidth=t.width,e.files.push(i),n--}))}));var s=setInterval((function(){if(0===n){var t=e.$refs.imageDiv.clientHeight-24,i=e.$refs.imageDiv.clientWidth-16;e.files.forEach((function(e){var n=1;n=t/i<e.baseHeight/e.baseWidth?t/e.baseHeight:i/e.baseWidth,e.image.width=e.baseWidth*n,e.image.height=e.baseHeight*n,e.baseWidth=e.image.width,e.baseHeight=e.image.height})),e.files.length>0?e.activeFileIndex=0:e.activeFileIndex=null,e.$forceUpdate(),clearInterval(s)}}),200)},addImage:function(){var t=this,e=[];null===this.uploadUrl?alert("Не указан URL для загрузки картинок"):this.files.forEach((function(i){var n=new FormData;n.append("width",i.image.width),n.append("height",i.image.height),n.append("image",i.file),fetch(t.uploadUrl,{method:"POST",body:n}).then((function(t){return t.json()})).then((function(t){e.push(t.image_path)}))}));var i=setInterval((function(){e.length===t.files.length&&(t.showModal=!1,t.$emit("insert-images",e),clearInterval(i))}),200)}}}),kt=Et,It=(i("f836"),Object(o["a"])(kt,Ct,_t,!1,null,null,null)),Ot=It.exports,zt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showModal,expression:"showModal"}],staticClass:"modal-mask"},[i("div",{staticClass:"modal-wrapper"},[i("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("Вставить ссылку")]),i("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){t.showModal=!1}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),i("div",{staticClass:"modal-body"},[i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"urlInput"}},[t._v("Ссылка:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.url,expression:"url"}],staticClass:"form-control",attrs:{type:"url",id:"urlInput"},domProps:{value:t.url},on:{input:function(e){e.target.composing||(t.url=e.target.value)}}})]),i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"textInput"}},[t._v("Замещающий текст:")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control",attrs:{type:"url",id:"textInput"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})])]),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.showModal=!1}}},[t._v("Отмена")]),i("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.addLink}},[t._v("Добавить ")])])])])])])])},Ft=[],Mt={name:"linkModal",props:{},data:function(){return{showModal:!1,url:"",text:""}},computed:{},watch:{},methods:{toggle:function(){this.url="",this.text="",this.showModal=!0},addLink:function(){this.showModal=!1,this.$emit("insert-link",this.url,this.text)}}},$t=Mt,Tt=(i("f5a9"),Object(o["a"])($t,zt,Ft,!1,null,null,null)),jt=Tt.exports,Lt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showModal,expression:"showModal"}],staticClass:"modal-mask"},[i("div",{staticClass:"modal-wrapper"},[i("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-header"},[i("h5",{staticClass:"modal-title"},[t._v("Вставить программый код")]),i("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){t.showModal=!1}}},[i("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),i("div",{staticClass:"modal-body"}),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.showModal=!1}}},[t._v("Отмена")]),i("button",{staticClass:"btn btn-primary",attrs:{type:"button"}},[t._v("Добавить ")])])])])])])])},At=[],Pt={name:"codeModal",props:{},data:function(){return{showModal:!1}},computed:{},watch:{},methods:{toggle:function(){this.showModal=!0}}},Ht=Pt,Nt=(i("9ee7"),Object(o["a"])(Ht,Lt,At,!1,null,null,null)),Wt=Nt.exports,Dt={name:"wysiwygMath",components:{mathFormula:vt,formulaModal:St,imageModal:Ot,linkModal:jt,codeModal:Wt},props:{id:String,placeholder:String,imageUploadUrl:{type:String,default:null},functions:{type:Array,default:function(){return[]}}},data:function(){return{showPopup:!1,hideTimeout:null,preventHideFlag:!1,data:"",selection:null,range:null,align:"left",fontStyles:[{tag:"b",icon:"fas fa-bold",style:"bold",selected:!1},{tag:"i",icon:"fas fa-italic",style:"italic",selected:!1},{tag:"u",icon:"fas fa-underline",style:"underline",selected:!1},{tag:"strike",icon:"fas fa-strikethrough",style:"strikethrough",selected:!1}],lists:[{tag:"ul",icon:"fas fa-list-ul",style:"insertUnorderedList",selected:!1},{tag:"ol",icon:"fas fa-list-ol",style:"insertOrderedList",selected:!1}],textStyles:[{tag:"left",icon:"fas fa-align-left",style:"left",selected:!1},{tag:"center",icon:"fas fa-align-center",style:"center",selected:!1},{tag:"right",icon:"fas fa-align-right",style:"right",selected:!1},{tag:"justify",icon:"fas fa-align-justify",style:"justify",selected:!1}],fontSizes:[{name:"x-small",value:"1"},{name:"small",value:"2"},{name:"medium",value:"3"},{name:"large",value:"4"},{name:"x-large",value:"5"},{name:"xx-large",value:"6"},{name:"xxx-large",value:"7"}],selectedFontSize:12,newFontSizes:[8,9,10,11,12,14,18,24,30,36,48,60,72,96],updateFormulaTimeout:null}},computed:{cursorPos:function(){try{return this.range.startOffset}catch(t){return-1}},textStylesEnabled:function(){return this.functions.includes("textStyle")},fontSizeEnabled:function(){return this.functions.includes("fontSize")},textAlignEnabled:function(){return this.functions.includes("textAlign")},listsEnabled:function(){return this.functions.includes("lists")},linksEnabled:function(){return this.functions.includes("linkInsert")},codeEnabled:function(){return this.functions.includes("codeInsert")},imagesEnabled:function(){return this.functions.includes("imageInsert")},formulasEnabled:function(){return this.functions.includes("formulaInsert")},redoEnabled:function(){return this.functions.includes("redo")}},watch:{},methods:{focus:function(){this.$refs.textarea.focus()},preventHide:function(){this.preventHideFlag=!0},setStyle:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(document.execCommand(t,i,n),this.$refs.textarea.focus(),s){var a=this.fontStyles.find((function(e){return e.style===t}));a&&(a.selected=!a.selected)}else setTimeout((function(){e.analyze()}),100)},resetChildStyle:function(t,e){var i=this;t instanceof HTMLElement&&Array.from(t.children).forEach((function(t){t.style[e]=null,i.resetChildStyle(t,e)}))},isEditor:function(t){return void 0!==t.classList&&Array.from(t.classList).includes("editor")},textAlign:function(t){var e=this,i=this.selection.getRangeAt(0).commonAncestorContainer;if(this.resetChildStyle(i,"textAlign"),this.isEditor(i)){var n=this.range.extractContents(),s=document.createElement("p");s.style.textAlign=t,s.appendChild(n),this.range.insertNode(s)}else{while("p"!==i.nodeName.toLowerCase())i=i.parentNode;i.style.textAlign=t}this.$refs.textarea.focus(),setTimeout((function(){e.analyze()}),100)},hideSelf:function(){this.preventHideFlag?this.preventHideFlag=!this.preventHideFlag:(this.showPopup=!1,this.$emit("focusout"))},createFormula:function(){this.$refs.formulaAddModal.toggle()},insertImage:function(){this.$refs.imageAddModal.toggle()},insertLink:function(){this.$refs.linkAddModal.toggle()},insertCode:function(){this.$refs.codeAddModal.toggle()},onDivInput:function(t){this.$emit("input",t.target.innerHTML),this.data=t.target.innerHTML;var e=/^(\n)*$/;e.test(t.target.innerText)&&(this.$refs.textarea.innerHTML='<p><span class="wrapper" style="font-size: '.concat(this.selectedFontSize,'pt;">&#65279;</span></p>'))},onDataRawInput:function(){this.$refs.textarea.innerHTML=this.data},removeFontSizeRecursive:function(t){var e=this;void 0!==t.style&&t.removeAttribute("style"),Array.from(t.children).forEach((function(t){e.removeFontSizeRecursive(t)}))},removeEmptyWrappers:function(){this.$refs.textarea.querySelectorAll(".wrapper").forEach((function(t){""===t.textContent&&t.remove()}))},removeWrappers:function(t,e,i){var n=this;console.log("deepness = ".concat(i)),t.querySelectorAll(".wrapper").forEach((function(t){var s=document.createElement("span");s.innerHTML=t.innerHTML,t.parentNode.insertBefore(s,t),n.removeWrappers(t,!0,i+1),e&&t.parentNode.removeChild(t)}))},findWrapper:function(t,e){return console.log(t),console.log(e),"SPAN"===t.parentNode.tagName?t.parentNode.textContent!==e?this.findWrapper(t.parentNode,e):t:null},changeFontSize:function(){var t=this,e=this.selectedFontSize;if("\ufeff"===this.$refs.textarea.textContent)this.$refs.textarea.innerHTML='<p><span class="wrapper" style="font-size: '.concat(this.selectedFontSize,'pt;">&#65279;</span></p>');else{var i,n=this.range.extractContents(),s=!1,a=document.createElement("span"),o=n.cloneNode(!0);a.appendChild(o),void 0!==this.range.commonAncestorContainer.classList&&this.range.commonAncestorContainer.classList.contains("wrapper")&&this.range.commonAncestorContainer.textContent===a.textContent?i=this.range.commonAncestorContainer:(s=!0,i=document.createElement("span"),i.classList.add("wrapper")),i.style.fontSize=this.selectedFontSize.toString()+"pt",i.innerHTML="&#65279;",i.appendChild(n),Array.from(i.children).forEach((function(e){return t.removeFontSizeRecursive(e)})),a.remove(),this.removeEmptyWrappers(),s?this.range.insertNode(i):(this.range.selectNodeContents(i),this.selection.removeAllRanges(),this.selection.addRange(this.range))}this.range.collapse(!1),this.updateData(),this.$nextTick((function(){t.$refs.textarea.focus(),t.selectedFontSize=e}))},getRenderedFormula:function(t){var e=n["a"].extend(vt),i=new e({propsData:{latex:t}});return i.$mount(),i},onInsertLaTeX:function(t){var e=this.getRenderedFormula(t),i=document.createTextNode("\ufeff");this.range.insertNode(i),this.range.insertNode(e.$el),this.range.collapse(!1),this.selection.removeAllRanges(),this.selection.addRange(this.range),this.$refs.textarea.focus()},onModifyLaTeX:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.getRenderedFormula(t.latex);t.element.parentNode.insertBefore(i.$el,t.element),t.element.parentNode.removeChild(t.element),e||(this.selection.removeAllRanges(),this.selection.addRange(this.range),this.selection.collapseToEnd(),this.$refs.textarea.focus())},onInsertImages:function(t){var e=this;t.forEach((function(t){var i=new Image;i.src=t;var n=document.createElement("p");n.appendChild(i),e.range.insertNode(n),e.selection.removeAllRanges(),e.selection.addRange(e.range),e.selection.collapseToEnd(),e.$refs.textarea.focus()}))},onInsertLink:function(t,e){var i=document.createElement("a");i.appendChild(document.createTextNode(e)),i.href=t,i.target="blank",i.contentEditable=!1,this.range.insertNode(i),this.selection.removeAllRanges(),this.selection.addRange(this.range),this.selection.collapseToEnd(),this.$refs.textarea.focus()},onInsertCode:function(){},rerenderFormulas:function(){var t=this;this.$refs.textarea.querySelectorAll(".wysiwyg-math-formula").forEach((function(e){t.onModifyLaTeX({element:e,latex:e.dataset.latex},!0)}))},updateData:function(){this.data=this.$refs.textarea.innerHTML},updateCursorPos:function(t){var e=window.getSelection();this.$refs.textarea.contains(e.anchorNode)&&(this.selection=e,this.range=this.selection.getRangeAt(0),null!==t&&"type"in t&&"click"===t.type?setTimeout(this.analyze,100):this.analyze())},analyze:function(){var t,e=this.selection,i=[],n={};if(e.rangeCount){t=e.getRangeAt(0).commonAncestorContainer;while(1){if(null==t)break;var s=t.nodeName.toLowerCase();if(t===this.$refs.textarea)break;function a(t,e){try{return""!==t[e]?t[e]:null}catch(i){return null}}"textAlign"in n&&null!==n.textAlign||(n.textAlign=a(t.style,"textAlign")),"fontSize"in n&&null!==n.fontSize||(n.fontSize=a(t.style,"fontSize")),"fontWeight"in n&&null!==n.fontWeight||(n.fontWeight=a(t.style,"fontWeight")),i.push(s),t=t.parentNode}}if(![void 0,null].includes(n.fontSize)){var o=parseInt(n.fontSize.slice(0,-2)),l=n.fontSize.slice(-2);"px"===l&&(o*=3/4),this.selectedFontSize=o}this.lists.forEach((function(t){return t.selected=i.includes(t.tag)})),this.fontStyles.forEach((function(t){return t.selected=i.includes(t.tag)})),"bolder"===n.fontWeight&&(this.fontStyles[0].selected=!0);var r=!1;this.textStyles.forEach((function(t){t.selected=n.textAlign===t.tag,t.selected&&(r=!0)})),r||(this.textStyles[0].selected=!0)},increaseFont:function(){var t=window.getSelection().getRangeAt(0).commonAncestorContainer.parentElement;if(t!==this.$refs.textarea){if(""!==t.style.fontSize){var e=this.fontSizes.map((function(t){return t.name})).indexOf(t.style.fontSize);e<this.fontSizes.length-1&&(document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[e+1].value),document.execCommand("styleWithCSS",!1,!1))}}else document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[3].value),document.execCommand("styleWithCSS",!1,!1)},decreaseFont:function(){var t=window.getSelection().getRangeAt(0).commonAncestorContainer.parentElement;if(t!==this.$refs.textarea){if(""!==t.style.fontSize){var e=this.fontSizes.map((function(t){return t.name})).indexOf(t.style.fontSize);e>0&&(document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[e-1].value),document.execCommand("styleWithCSS",!1,!1))}}else document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[1].value),document.execCommand("styleWithCSS",!1,!1)}},beforeCreate:function(){},beforeMount:function(){},mounted:function(){var t=this;window.bus=new n["a"]({}),window.bus.$on("formula-click",(function(e){t.$refs.formulaEditModal.toggle(e)})),document.execCommand("defaultParagraphSeparator",!1,"p"),this.$refs.textarea.innerHTML='<p><span class="wrapper" style="font-size: 12pt;">&#65279;</span></p>';var e=function(e){t.updateCursorPos(e)};document.addEventListener("mouseup",e),this.$once("hook:beforeDestroy",(function(){return document.removeEventListener("mouseup",e)}))}},Rt=Dt,Ut=(i("f268"),Object(o["a"])(Rt,ct,dt,!1,null,"32fc59a8",null)),Gt=Ut.exports,Xt={name:"TextObject",components:{WysiwygMath:Gt},props:["html"],data:function(){return{isActive:!1}},computed:{},watch:{},methods:{focus:function(){this.$refs.wysimath.focus(),this.isActive=!0,this.$emit("focusin")},onFocusOut:function(){this.isActive=!1,this.$emit("focusout")}},created:function(){},mounted:function(){this.$emit("update-actions",[{icon:"far fa-edit",func:this.focus}]),window.renderMathInElement(document.body)}},Yt=Xt,qt=(i("f887"),Object(o["a"])(Yt,lt,rt,!1,null,"711eb48d",null)),Zt=qt.exports,Bt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content",domProps:{innerHTML:t._s(t.html)}})},Kt=[],Jt={name:"YouTubeObject",props:["html"],data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},Vt=Jt,Qt=(i("b331"),Object(o["a"])(Vt,Bt,Kt,!1,null,"11387f13",null)),te=Qt.exports,ee={name:"SlideElement",components:{TextObject:Zt,YouTubeObject:te},props:["element","slideWidth","slideHeight","cellSize"],data:function(){return{isElementFocused:!1,isInnerFocused:!1,isMoving:!1,defaultZ:"20",activeZ:"21",actions:[],x:0,y:0,width:0,height:0}},computed:{position:function(){return[this.x,this.y]},size:function(){return[this.width,this.height]},isOutside:function(){return this.x<0||this.y<0||this.x+this.width>this.slideWidth||this.y+this.height>this.slideHeight},isOnlyElementFocused:function(){return this.isElementFocused&&!this.isInnerFocused},movableClasses:function(){return{focused:this.isElementFocused,selected:this.isInnerFocused,outside:this.isOutside,inactive:!this.isElementFocused&&!this.isInnerFocused,bordered:this.$store.state.slideParams.showGrid}}},watch:{position:function(){this.moveSlideElement({id:this.element.id,x:this.x,y:this.y}),this.$refs.movable.style.left=this.x*this.cellSize+"px",this.$refs.movable.style.top=this.y*this.cellSize+"px"},size:function(){this.resizeSlideElement({id:this.element.id,width:this.width,height:this.height}),this.$refs.movable.style.width=this.width*this.cellSize+"px",this.$refs.movable.style.height=this.height*this.cellSize+"px"},isElementFocused:function(t){var e=this;t&&setTimeout((function(){e.initializeSizeChanger(e.$refs.top,!1,!0),e.initializeSizeChanger(e.$refs.right,!0,!1),e.initializeSizeChanger(e.$refs.bottom,!1,!1),e.initializeSizeChanger(e.$refs.left,!0,!0)}),100)}},methods:Object(h["a"])(Object(h["a"])({},Object(O["d"])({moveSlideElement:A,resizeSlideElement:P})),{},{getPosition:function(){return{x:this.x,y:this.y}},getSize:function(){return{width:this.width,height:this.height}},moveSelfInside:function(){this.isOutside&&(this.x<0&&(this.x=0),this.y<0&&(this.y=0),this.x+this.width>this.slideWidth&&(this.x=this.slideWidth-this.width),this.y+this.height>this.slideHeight&&(this.y=this.slideHeight-this.height)),this.isOutside&&(this.width>this.slideWidth&&(this.width=this.slideWidth),this.height>this.slideHeight&&(this.height=this.slideHeight),this.moveSelfInside())},initializeMovable:function(){var t=this,e=this.$refs.movable;e.ondragstart=function(){return!1},e.onmousedown=function(i){if(!t.isInnerFocused){t.isMoving=!0,e.style.zIndex=t.activeZ;var n=i.clientX,s=i.clientY,a=t.getPosition(),o=function(e){var i=Math.round((e.clientX-n)/t.cellSize),o=Math.round((e.clientY-s)/t.cellSize);t.x=a.x+i,t.y=a.y+o};document.addEventListener("mousemove",o),document.onmouseup=function(){t.moveSelfInside(),t.isMoving=!1,e.style.zIndex=t.defaultZ,document.removeEventListener("mousemove",o),document.onmouseup=null}}}},initializeSizeChanger:function(t,e,i){var n=this;void 0!==t&&(t.ondragstart=function(){return!1},t.onmousedown=function(s){s.stopPropagation(),n.isMoving=!0,t.style.zIndex=n.activeZ;var a=s.clientX,o=s.clientY,l=n.getSize(),r=n.getPosition(),c=function(t){var s=Math.round((t.clientX-a)/n.cellSize),c=Math.round((t.clientY-o)/n.cellSize);e?i?(n.x=r.x+s,n.width=l.width-s):n.width=l.width+s:i?(n.y=r.y+c,n.height=l.height-c):n.height=l.height+c};document.addEventListener("mousemove",c),document.onmouseup=function(){n.moveSelfInside(),n.isMoving=!1,t.style.zIndex=n.defaultZ,document.removeEventListener("mousemove",c),document.onmouseup=null}})},deleteSelf:function(){this.$store.commit(L,this.element.id)},onKeyUp:function(t){this.isOnlyElementFocused&&"Delete"===t.key&&this.deleteSelf()},onDoubleClick:function(){this.$refs.inner_component.focus()},updateActions:function(t){console.log(t),this.actions=t},test:function(){console.log("test")}}),created:function(){var t=this;Object.entries(this.element).forEach((function(e){var i=Object(ot["a"])(e,2),n=i[0],s=i[1];return t[n]=s}))},mounted:function(){this.initializeMovable()}},ie=ee,ne=(i("ebb3"),Object(o["a"])(ie,st,at,!1,null,"4a11f2d8",null)),se=ne.exports,ae={name:"Slide",components:{SlideElement:se},data:function(){return{backgroundSize:"calc(100% / 16) calc(100% / 9)",multiplier:4}},computed:Object(h["a"])(Object(h["a"])({},Object(O["e"])({slideWidth:function(t){return t.slideParams.width},slideHeight:function(t){return t.slideParams.height},cellSize:function(t){return t.slideParams.cellSize}})),Object(O["c"])(["activeSlideElements"])),watch:{},methods:{test:function(){console.log("test")},setGridSize:function(){this.$store.commit($,this.$refs.slide.clientWidth/this.slideWidth),this.backgroundSize="".concat(100/this.slideWidth,"% ").concat(100/this.slideHeight,"%")}},created:function(){},mounted:function(){this.setGridSize()}},oe=ae,le=(i("1dc0"),Object(o["a"])(oe,it,nt,!1,null,"63ce2fe7",null)),re=le.exports,ce={name:"SlideEditor",components:{Slide:re,RatioKeeper:et},props:{},computed:Object(h["a"])({},Object(O["c"])(["activeSlide"])),methods:Object(h["a"])(Object(h["a"])(Object(h["a"])({},Object(O["d"])({setSlideType:M,toggleGrid:T})),Object(O["b"])({addImage:q,addYouTube:Z})),{},{addText:function(){this.$store.dispatch(Y,{x:5,y:5,width:20,height:10})},logState:function(){console.log(this.$store.state)}})},de=ce,ue=(i("d5ca"),Object(o["a"])(de,G,X,!1,null,null,null)),fe=ue.exports,he={name:"SingleChoice",components:{SlideEditor:fe},props:{},computed:{},methods:{}},me=he,pe=Object(o["a"])(me,R,U,!1,null,"0489223a",null),ve=pe.exports,ge=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("SlideEditor",{attrs:{id:"slide_editor"},scopedSlots:t._u([{key:"params",fn:function(){return[i("div",{staticClass:"col"},[t._v(" Info params ")])]},proxy:!0},{key:"controls",fn:function(){return[t._v(" Info controls ")]},proxy:!0}])})},be=[],ye={name:"Info",components:{SlideEditor:fe},props:{},computed:{},methods:{}},we=ye,xe=Object(o["a"])(we,ge,be,!1,null,"a26383e6",null),Se=xe.exports,Ce={name:"Editor",components:{Heading:y,Sidebar:D,SingleChoice:ve,Info:Se},computed:Object(h["a"])({isAnySlideSelected:function(){return void 0!==this.activeSlide}},Object(O["c"])(["activeSlide","activeSlideComponent"]))},_e=Ce,Ee=(i("eb0e"),Object(o["a"])(_e,u,f,!1,null,"6ece83f0",null)),ke=Ee.exports;n["a"].use(d["a"]);var Ie,Oe,ze=[{path:"/",name:"Editor",component:ke}],Fe=new d["a"]({mode:"history",base:"/",routes:ze}),Me=Fe,$e=i("ade3");i("a434");n["a"].use(O["a"]);var Te=new O["a"].Store({state:{newSlideId:1,newSlideElementId:1,slideParams:{width:64,height:36,cellSize:0,showGrid:!0},activeSlideId:null,slides:[],slideTypes:[{id:1,name:"ТЕСТ: Единственный выбор",component:"SingleChoice"},{id:8,name:"Информация",component:"Info"}]},getters:{activeSlide:function(t){return t.slides.find((function(e){return e.id===t.activeSlideId}))},activeSlideElements:function(t,e){return e.activeSlide.slideElements},activeSlideComponent:function(t,e){return t.slideTypes.find((function(t){return t.id===e.activeSlide.type})).component}},mutations:(Ie={increaseNewSlideId:function(t){t.newSlideId++},increaseNewSlideElementId:function(t){t.newSlideElementId++}},Object($e["a"])(Ie,z,(function(t){var e={id:t.newSlideId,type:1,slideElements:[]};t.slides.push(e),t.activeSlideId=e.id})),Object($e["a"])(Ie,F,(function(t,e){t.activeSlideId=e})),Object($e["a"])(Ie,M,(function(t,e){var i=t.slides.find((function(e){return e.id===t.activeSlideId}));i.type=parseInt(e)})),Object($e["a"])(Ie,$,(function(t,e){t.slideParams.cellSize=e})),Object($e["a"])(Ie,T,(function(t){t.slideParams.showGrid=!t.slideParams.showGrid})),Object($e["a"])(Ie,j,(function(t,e){var i=t.slides.find((function(e){return e.id===t.activeSlideId})).slideElements;i.push(Object(h["a"])({id:t.newSlideElementId},e))})),Object($e["a"])(Ie,L,(function(t,e){var i=t.slides.find((function(e){return e.id===t.activeSlideId})).slideElements,n=i.map((function(t){return t.id})).indexOf(e);i.splice(n,1)})),Object($e["a"])(Ie,A,(function(t,e){var i=e.id,n=e.x,s=e.y,a=t.slides.find((function(e){return e.id===t.activeSlideId})).slideElements.find((function(t){return t.id===i}));a.x=n,a.y=s})),Object($e["a"])(Ie,P,(function(t,e){var i=e.id,n=e.width,s=e.height,a=t.slides.find((function(e){return e.id===t.activeSlideId})).slideElements.find((function(t){return t.id===i}));a.width=n,a.height=s})),Ie),actions:(Oe={},Object($e["a"])(Oe,Y,(function(t,e){var i=t.state,n=t.commit;n(j,Object(h["a"])(Object(h["a"])({},e),{},{content:{component:"TextObject",html:"<b>".concat(i.newSlideElementId,"</b>")}}))})),Object($e["a"])(Oe,q,(function(t){t.commit})),Object($e["a"])(Oe,Z,(function(t){t.commit})),Oe),modules:{},strict:!1});n["a"].config.productionTip=!1,Te.subscribe((function(t){[z].includes(t.type)&&Te.commit("increaseNewSlideId"),[j].includes(t.type)&&Te.commit("increaseNewSlideElementId")})),new n["a"]({router:Me,store:Te,render:function(t){return t(c)}}).$mount("#app")},"5af5":function(t,e,i){},"5c0b":function(t,e,i){"use strict";i("9c0c")},"5d7e":function(t,e,i){},"5de5":function(t,e,i){},"5df0":function(t,e,i){},"869c":function(t,e,i){},9266:function(t,e,i){},"9c0c":function(t,e,i){},"9ee7":function(t,e,i){"use strict";i("5d7e")},a02d:function(t,e,i){},a41c:function(t,e,i){},b331:function(t,e,i){"use strict";i("9266")},b6af:function(t,e,i){"use strict";i("5108")},bdff:function(t,e,i){},be20:function(t,e,i){"use strict";i("bdff")},c227:function(t,e,i){},d09c:function(t,e,i){"use strict";i("43fb")},d189:function(t,e,i){"use strict";i("869c")},d5ca:function(t,e,i){"use strict";i("e8af")},e8af:function(t,e,i){},eb0e:function(t,e,i){"use strict";i("198b")},ebb3:function(t,e,i){"use strict";i("f385")},f268:function(t,e,i){"use strict";i("5af5")},f385:function(t,e,i){},f5a9:function(t,e,i){"use strict";i("5de5")},f836:function(t,e,i){"use strict";i("a41c")},f887:function(t,e,i){"use strict";i("278a")},f8c1:function(t,e,i){"use strict";i("a02d")}});
//# sourceMappingURL=app.876476ca.js.map