(function(t){function e(e){for(var o,r,s=e[0],l=e[1],u=e[2],d=0,f=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&f.push(n[r][0]),n[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);c&&c(e);while(f.length)f.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],o=!0,s=1;s<a.length;s++){var l=a[s];0!==n[l]&&(o=!1)}o&&(i.splice(e--,1),t=r(r.s=a[0]))}return t}var o={},n={app:0},i=[];function r(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=o,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(a,o,function(e){return t[e]}.bind(null,o));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var c=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var o=a("85ec"),n=a.n(o);n.a},"1a85":function(t,e,a){"use strict";var o=a("a152"),n=a.n(o);n.a},"2aee":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{attrs:{id:"nav"}},[a("router-link",{attrs:{to:"/jax"}},[t._v("wysiwygMath - MathJax")])],1),a("div",{staticStyle:{padding:"40px"}},[a("keep-alive",[a("router-view")],1)],1)])},i=[],r={created:function(){"/jax"!==this.$router.currentRoute.path&&this.$router.push("/jax")}},s=r,l=(a("034f"),a("2877")),u=Object(l["a"])(s,n,i,!1,null,null,null),c=u.exports,d=a("8c4f"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._m(0),a("transition",{attrs:{name:"fade"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.showPopup,expression:"showPopup"}],staticClass:"popup",on:{mousedown:t.preventHide}},[a("span",{staticClass:"border-right"},t._l(t.fontStyles,(function(e,o){return a("button",{key:o,class:{selected:e.selected},on:{click:function(a){return t.setStyle(e.style,!1,null,!0)}}},[a("i",{class:e.icon})])})),0),a("span",{staticClass:"border-right"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedFontSize,expression:"selectedFontSize"}],on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedFontSize=e.target.multiple?a:a[0]},t.changeFontSize]}},t._l(t.newFontSizes,(function(e){return a("option",{key:e},[t._v(t._s(e))])})),0)]),a("span",{staticClass:"border-right"},[a("button",{on:{click:function(e){return t.setStyle("justifyLeft")}}},[a("i",{staticClass:"fas fa-align-left"})]),a("button",{on:{click:function(e){return t.setStyle("justifyCenter")}}},[a("i",{staticClass:"fas fa-align-center"})]),a("button",{on:{click:function(e){return t.setStyle("justifyRight")}}},[a("i",{staticClass:"fas fa-align-right"})]),a("button",{on:{click:function(e){return t.setStyle("justifyFull")}}},[a("i",{staticClass:"fas fa-align-justify"})])]),a("span",{staticClass:"border-right"},[a("button",{on:{click:function(e){return t.setStyle("insertUnorderedList")}}},[a("i",{staticClass:"fas fa-list-ul"})]),a("button",{on:{click:function(e){return t.setStyle("insertOrderedList")}}},[a("i",{staticClass:"fas fa-list-ol"})])]),a("span",{staticClass:"border-right"},[a("button",{on:{click:t.createFormula}},[a("i",{staticClass:"fas fa-square-root-alt"})])]),a("span",{},[a("button",{on:{click:function(e){return t.setStyle("undo")}}},[a("i",{staticClass:"fas fa-undo-alt"})])])])]),a("div",{ref:"textarea",staticClass:"form-control editor",style:"height: calc(1.5em * "+t.rows+" + .75rem + 2px); display: inline-block",attrs:{id:t.id,placeholder:t.placeholder,contenteditable:""},on:{focusin:function(e){t.showPopup=!0},focusout:t.hideSelf,input:t.onDivInput,change:t.onDivInput,click:t.updateCursorPos,keyup:t.updateCursorPos}}),t._v(" cursorPos = "+t._s(t.cursorPos)+" "),a("div",[t._v(" dataRaw "),a("div",[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.data,expression:"data"}],attrs:{cols:"100",rows:"10"},domProps:{value:t.data},on:{input:[function(e){e.target.composing||(t.data=e.target.value)},t.onDataRawInput],change:t.onDataRawInput}})])]),a("formula-modal",{ref:"formulaAddModal",on:{"insert-latex":t.insertLaTeX}}),a("formula-modal",{ref:"formulaEditModal",attrs:{"is-in-edit-mode":""},on:{"insert-latex":t.insertLaTeX2}})],1)},m=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex justify-content-end"},[a("h3",[t._v("MathJax")])])}],p=(a("7db0"),a("4160"),a("a630"),a("caad"),a("c975"),a("d81d"),a("b0c0"),a("a9e3"),a("d3b7"),a("25f0"),a("3ca3"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],ref:"formula",staticClass:"wysiwyg-math-formula",attrs:{contenteditable:"false"},domProps:{innerHTML:t._s("\\( "+t.latex+" \\)")},on:{dblclick:t.edit}})}),h=[],v={name:"mathFormula",props:{latex:String},data:function(){return{show:!1}},methods:{edit:function(){window.bus.$emit("formula-click",{element:this.$refs.formula,latex:this.latex})},render:function(){var t=this;this.show=!1,setTimeout((function(){window.MathJax.typeset(),t.show=!0}),100)}},mounted:function(){this.render()}},g=v,b=(a("1a85"),Object(l["a"])(g,p,h,!1,null,null,null)),w=b.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showModal,expression:"showModal"}],staticClass:"modal-mask"},[a("div",{staticClass:"modal-wrapper"},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v(t._s(t.isInEditMode?"Редактировать формулу":"Вставить формулу"))]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(e){t.showModal=!1}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"d-flex mb-3"},[a("div",{staticClass:"d-flex"},[a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"py-1 px-2 text-center",staticStyle:{"background-color":"#ffffff",position:"relative",cursor:"pointer","user-select":"none",margin:"1px",border:"rgb(133, 133, 133) solid 1px","border-radius":"4px"},style:t.showLetters?"border: black solid 2px; margin: 0;":"",attrs:{tabindex:"0"},on:{click:function(e){t.showLetters=!t.showLetters},focusout:t.hideSelf}},[t._v(" \\(\\alpha \\beta \\delta\\) ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showLetters,expression:"showLetters"}],staticStyle:{"z-index":"100","background-color":"#ffffff",position:"absolute",top:"100%",left:"0","margin-top":"8px",border:"black 2px solid","border-radius":"4px",padding:"4px",display:"grid","grid-template-columns":"repeat(8, 1fr)","flex-wrap":"wrap","text-align":"center"},on:{mousedown:t.preventHide}},t._l(t.letters,(function(e,o){return a("div",{key:o,staticClass:"letter",on:{click:function(a){return t.insertLetter(e)}}},[t._v(" \\( "+t._s(e)+" \\) ")])})),0)]),a("div",{staticClass:"ml-2",staticStyle:{position:"relative"}},[a("div",{staticClass:"py-1 px-2 text-center",staticStyle:{"background-color":"#ffffff",position:"relative",cursor:"pointer","user-select":"none",margin:"1px",border:"rgb(133, 133, 133) solid 1px","border-radius":"4px"},style:t.showOperators?"border: black solid 2px; margin: 0;":"",attrs:{tabindex:"0"},on:{click:function(e){t.showOperators=!t.showOperators},focusout:t.hideSelf}},[t._v(" \\(\\sum\\) ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showOperators,expression:"showOperators"}],staticStyle:{"z-index":"100","background-color":"#ffffff",position:"absolute",top:"100%",left:"0","margin-top":"8px",border:"black 2px solid","border-radius":"4px",padding:"4px",display:"grid","grid-template-columns":"repeat(4, 1fr)","flex-wrap":"wrap","text-align":"center"},on:{mousedown:t.preventHide}},t._l(t.operators,(function(e,o){return a("div",{key:o,staticClass:"letter",on:{click:function(a){return t.insertOperator(e)}}},[t._v(" \\("+t._s(e)+"\\) ")])})),0)]),a("div",{staticClass:"ml-2",staticStyle:{position:"relative"}},[a("div",{staticClass:"py-1 px-2 text-center",staticStyle:{"background-color":"#ffffff",position:"relative",cursor:"pointer","user-select":"none",margin:"1px",border:"rgb(133, 133, 133) solid 1px","border-radius":"4px"},style:t.showSymbols?"border: black solid 2px; margin: 0;":"",attrs:{tabindex:"0"},on:{click:function(e){t.showSymbols=!t.showSymbols},focusout:t.hideSelf}},[t._v(" \\(\\neq\\) ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showSymbols,expression:"showSymbols"}],staticStyle:{"z-index":"100","background-color":"#ffffff",position:"absolute",top:"100%",left:"0","margin-top":"8px",border:"black 2px solid","border-radius":"4px",padding:"4px",display:"grid","grid-template-columns":"repeat(7, 1fr)","flex-wrap":"wrap","text-align":"center"},on:{mousedown:t.preventHide}},t._l(t.symbols,(function(e,o){return a("div",{key:o,staticClass:"letter",on:{click:function(a){return t.insertSymbol(e)}}},[t._v(" \\("+t._s(e)+"\\) ")])})),0)])])]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formula,expression:"formula"}],ref:"formulaTextarea",staticStyle:{width:"100%"},attrs:{rows:"3",autofocus:""},domProps:{value:t.formula},on:{click:t.updateFormulaCursorPos,keydown:t.updateFormulaCursorPos,input:function(e){e.target.composing||(t.formula=e.target.value)}}}),a("div",{staticStyle:{"font-weight":"bolder",margin:".8rem 0 .4rem"}},[t._v("Результат:")]),a("div",{ref:"formulaPreview",staticStyle:{margin:".5rem 0",height:"40px"}})]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(e){t.showModal=!1}}},[t._v("Отмена")]),t.isInEditMode?a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.saveFormula}},[t._v("Сохранить ")]):a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.addFormula}},[t._v("Добавить ")])])])])])])])},x=[],S=(a("fb6a"),{name:"wysiwygMath",components:{mathFormula:w},props:{isInEditMode:{type:Boolean,default:!1}},data:function(){return{showModal:!1,updateFormulaTimeout:null,formula:"",data:null,showLetters:!1,showOperators:!1,showSymbols:!1,preventHideFlag:!1,changeOpacity:!1,letters:["\\alpha","\\beta","\\gamma","\\delta","\\epsilon","\\zeta","\\eta","\\theta","\\iota","\\kappa","\\lambda","\\mu","\\nu","\\pi","\\rho","\\sigma","\\tau","\\upsilon","\\phi","\\chi","\\psi","\\omega"],operators:["\\sqrt{ab}","\\sqrt[n]{ab}","\\log_{a}{b}","\\lg{ab}","a^{b}","a_{b} c_a^b","c_a^b","\\widetilde{ab}","\\widehat{ab}","\\overrightarrow{ab}","\\overline{ab}","\\frac{ab}{cd}","\\frac{\\partial a}{\\partial b}","\\frac{\\text{d}x}{\\text{d}y}","\\lim_{a \\rightarrow b}","\\int_{a}^{b}","\\prod_a^b","\\bigcap_a^b","\\bigcup_a^b","\\sum_a^b","\\left(\\begin{array}{c}a\\\\ b\\end{array}\\right)","\\begin{bmatrix}a & b \\\\c & d \\end{bmatrix}","\\begin{cases}a & x = 0\\\\b & x > 0\\end{cases}"],symbols:["\\times","\\div","\\pm","\\mp","\\cdot","\\star","\\neq","\\leq","\\geq","\\sim","\\approx","\\cong","\\equiv","\\ll","\\gg","\\in","\\subset","\\subseteq","\\ni","\\models","\\vdash","\\perp","\\mid","\\parallel","\\hat{a}","\\check{a}","\\acute{a}","\\tilde{a}","\\bar{a}","\\vec{a}","\\dot{a}","\\ddot{a}","\\leftarrow","\\Leftarrow","\\rightarrow","\\Rightarrow","\\leftrightarrow","\\Leftrightarrow","\\exists","\\forall","\\triangle","\\triangledown"]}},watch:{formula:function(){var t=this;this.updateFormulaTimeout&&clearTimeout(this.updateFormulaTimeout),this.updateFormulaTimeout=setTimeout((function(){t.$refs.formulaPreview.innerHTML="\\(".concat(t.formula,"\\)"),window.MathJax.typeset(),t.changeOpacity&&(t.$refs.formulaPreview.style.opacity=1,t.changeOpacity=!1)}),1500)}},methods:{toggle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.data=t,this.isInEditMode&&(this.$refs.formulaPreview.style.opacity=0,this.changeOpacity=!0,this.formula=t.latex),this.formula?this.$refs.formulaPreview.innerHTML="\\(".concat(this.formula,"\\)"):this.$refs.formulaPreview.innerHTML="",this.showModal=!0},test:function(){console.log("123")},preventHide:function(){this.preventHideFlag=!0},hideSelf:function(){this.preventHideFlag?this.preventHideFlag=!this.preventHideFlag:(this.showLetters=!1,this.showOperators=!1,this.showSymbols=!1)},updateData:function(){this.data=this.$refs.textarea.innerHTML},updateFormulaCursorPos:function(t){this.formulaCursorPos=t.target.selectionStart},insertToFormula:function(t){void 0!==this.formulaCursorPos?this.formula=this.formula.slice(0,this.formulaCursorPos)+" ".concat(t," ")+this.formula.slice(this.formulaCursorPos):this.formula+=" ".concat(t," ")},insertLetter:function(t){this.showLetters=!1,this.insertToFormula(t)},insertOperator:function(t){this.showOperators=!1,this.insertToFormula(t)},insertSymbol:function(t){this.showSymbols=!1,this.insertToFormula(t)},addFormula:function(){this.showModal=!1,this.$emit("insert-latex",this.formula)},editFormula:function(){console.log("editFormula")},saveFormula:function(){this.showModal=!1,this.data.latex=this.formula,this.$emit("insert-latex",this.data)}}}),C=S,_=(a("f8f0"),Object(l["a"])(C,y,x,!1,null,null,null)),k=_.exports,F={name:"wysiwygMath",components:{mathFormula:w,formulaModal:k},props:{id:String,placeholder:String,rows:{type:Number,default:5}},data:function(){return{showPopup:!1,hideTimeout:null,preventHideFlag:!1,formula:"x",data:"",selection:null,range:null,fontStyles:[{tag:"b",icon:"fas fa-bold",style:"bold",selected:!1},{tag:"i",icon:"fas fa-italic",style:"italic",selected:!1},{tag:"u",icon:"fas fa-underline",style:"underline",selected:!1},{tag:"strike",icon:"fas fa-strikethrough",style:"strikethrough",selected:!1}],fontSizes:[{name:"x-small",value:"1"},{name:"small",value:"2"},{name:"medium",value:"3"},{name:"large",value:"4"},{name:"x-large",value:"5"},{name:"xx-large",value:"6"},{name:"xxx-large",value:"7"}],selectedFontSize:12,newFontSizes:[8,9,10,11,12,14,18,24,30,36,48,60,72,96],updateFormulaTimeout:null}},computed:{cursorPos:function(){try{return this.range.startOffset}catch(t){return-1}}},watch:{formula:function(){var t=this;this.updateFormulaTimeout&&clearTimeout(this.updateFormulaTimeout),this.updateFormulaTimeout=setTimeout((function(){t.$refs.formulaPreview.innerHTML="\\(".concat(t.formula,"\\)"),window.MathJax.typeset()}),1500)}},methods:{preventHide:function(){this.preventHideFlag=!0},setStyle:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(document.execCommand(t,e,a),o){var n=this.fontStyles.find((function(e){return e.style===t}));n&&(n.selected=!n.selected)}},hideSelf:function(){this.preventHideFlag?this.preventHideFlag=!this.preventHideFlag:this.showPopup=!1},createFormula:function(){this.$refs.formulaAddModal.toggle()},onDivInput:function(t){this.$emit("input",t.target.innerHTML),this.data=t.target.innerHTML},onDataRawInput:function(){this.$refs.textarea.innerHTML=this.data},test:function(){console.log("test")},changeFontSize:function(){var t=this.selectedFontSize,e=this.range.extractContents();Array.from(e.children).forEach((function(t){return t.style.removeProperty("font-size")}));var a=document.createElement("span");a.style.fontSize=t.toString()+"pt",a.appendChild(e),this.range.insertNode(a),this.updateData()},insertLaTeX:function(t){var e=o["a"].mixin(w),a=new e({propsData:{latex:t}});a.$mount(),this.range.insertNode(a.$el),this.updateData(),this.selection.removeAllRanges(),this.selection.addRange(this.range),this.selection.collapseToEnd(),this.$refs.textarea.focus()},insertLaTeX2:function(t){var e=o["a"].mixin(w),a=new e({propsData:{latex:t.latex}});a.$mount(),t.element.parentNode.insertBefore(a.$el,t.element),t.element.parentNode.removeChild(t.element),this.$refs.textarea.focus()},updateData:function(){this.data=this.$refs.textarea.innerHTML},updateCursorPos:function(){this.selection=window.getSelection(),this.range=this.selection.getRangeAt(0),this.analyze()},analyze:function(){var t,e=this.selection,a=[];if(e.rangeCount){t=e.getRangeAt(0).commonAncestorContainer;while(1){if(t=t.parentNode,null==t)break;var o=t.nodeName.toLowerCase();if(t===this.$refs.textarea)break;a.push(o)}}this.fontStyles.forEach((function(t){return t.selected=a.includes(t.tag)}))},increaseFont:function(){var t=window.getSelection().getRangeAt(0).commonAncestorContainer.parentElement;if(t!==this.$refs.textarea){if(""!==t.style.fontSize){var e=this.fontSizes.map((function(t){return t.name})).indexOf(t.style.fontSize);e<this.fontSizes.length-1&&(document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[e+1].value),document.execCommand("styleWithCSS",!1,!1))}}else document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[3].value),document.execCommand("styleWithCSS",!1,!1)},decreaseFont:function(){var t=window.getSelection().getRangeAt(0).commonAncestorContainer.parentElement;if(t!==this.$refs.textarea){if(""!==t.style.fontSize){var e=this.fontSizes.map((function(t){return t.name})).indexOf(t.style.fontSize);e>0&&(document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[e-1].value),document.execCommand("styleWithCSS",!1,!1))}}else document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,this.fontSizes[1].value),document.execCommand("styleWithCSS",!1,!1)}},beforeCreate:function(){},beforeMount:function(){window.MathJax={options:{enableMenu:!1}}},mounted:function(){var t=this;window.bus=new o["a"]({}),window.bus.$on("formula-click",(function(e){t.$refs.formulaEditModal.toggle(e)}))}},M=F,T=(a("dcb6"),Object(l["a"])(M,f,m,!1,null,null,null)),P=T.exports;o["a"].use(d["a"]);var $=[{path:"/jax",name:"wysiwygMathJax",component:P}],z=new d["a"]({routes:$}),O=z,L=window.MathJax;o["a"].prototype.$mathjax=L,o["a"].config.productionTip=!1,new o["a"]({router:O,render:function(t){return t(c)}}).$mount("#app")},"85ec":function(t,e,a){},a152:function(t,e,a){},dcb6:function(t,e,a){"use strict";var o=a("2aee"),n=a.n(o);n.a},eb0f:function(t,e,a){},f8f0:function(t,e,a){"use strict";var o=a("eb0f"),n=a.n(o);n.a}});
//# sourceMappingURL=app.23da8ab8.js.map